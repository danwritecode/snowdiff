# Snowdiff

**Note: This README is 100% LLM generated**

A fast, pragmatic TUI tool to compare Snowflake table and view schemas using DDL files.  
Quickly see what tables, views, and columns are missing or different between two environments.

---

## Features

- **Compares two sets of Snowflake DDLs** (source and target)
- **Reports missing tables, views, and columns** in either direction
- **Handles Snowflake-specific quirks** (e.g., TIMESTAMP_NTZ, unsupported DDLs)
- **Works with DDLs generated by `GET_DDL` or `SHOW CREATE`**

---

## Usage

### 1. **Prepare Your DDL Files**

Export your source and target schema DDLs from Snowflake.  
For example, using the Snowflake worksheet or CLI:

```sql
-- For Target
SELECT GET_DDL('DATABASE', 'MYDB', TRUE);
-- For Source
SELECT GET_DDL('DATABASE', 'MYDB_DEV', TRUE);
```

Save the DDLs to two files, e.g.:
- `source.sql`
- `target.sql`

### 2. **Build the Tool** (Only if deploying, otherwise see Run)

```sh
cargo build --release
```

### 3. **Run the Tool**

Update the `main.rs` to point to your DDL files, or use `include_str!` as in the POC:

```rust
let source_sql = include_str!("../ddls/source.sql");
let target_sql = include_str!("../ddls/target.sql");
```

Then run:

```sh
cargo r
```

## How It Works

- **Preprocesses** DDL to handle Snowflake-specific types and remove unsupported statements.
- **Parses** DDL into an AST using [`sqlparser-rs`](https://github.com/sqlparser-rs/sqlparser-rs).
- **Normalizes** database names for cross-environment comparison.
- **Diffs** tables, views, and columns (including types).

---

## Limitations

- Only compares **tables and views** (not other object types).
- Requires DDLs to be exported from Snowflake.
- No CLI arguments yetâ€”edit the file paths in `main.rs`.
- Does not connect directly to Snowflake (yet).

---
